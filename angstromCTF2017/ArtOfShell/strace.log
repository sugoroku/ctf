execve("./art_of_the_shell", ["./art_of_the_shell", "H1\300H1\322H\273//bin/shH\301\353\10SH\211\347PWH\211\346\260;\17\5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBB\376\5@"], [/* 33 vars */]execve("./art_of_the_shell", ["./art_of_the_shell", "H1\300H1\322H\273//bin/shH\301\353\10SH\211\347PWH\211\346\260;\17\5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBB\376\5@"], [/* 33 vars */]) = 0
) = 0
brk(NULLbrk(NULL)                               = 0x19d2000
)                               = 0x19d2000
access("/etc/ld.so.nohwcap", F_OKaccess("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
)      = -1 ENOENT (No such file or directory)
mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fb6a0929000
) = 0x7fb6a0929000
access("/etc/ld.so.preload", R_OKaccess("/etc/ld.so.preload", R_OK)      = -1 ENOENT (No such file or directory)
)      = -1 ENOENT (No such file or directory)
open("/etc/ld.so.cache", O_RDONLY|O_CLOEXECopen("/etc/ld.so.cache", O_RDONLY|O_CLOEXEC) = 3
) = 3
fstat(3, fstat(3, {st_mode=S_IFREG|0644, st_size=97481, ...}) = 0
{st_mode=S_IFREG|0644, st_size=97481, ...}) = 0
mmap(NULL, 97481, PROT_READ, MAP_PRIVATE, 3, 0mmap(NULL, 97481, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7fb6a0911000
) = 0x7fb6a0911000
close(3close(3)                                = 0
)                                = 0
access("/etc/ld.so.nohwcap", F_OKaccess("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
)      = -1 ENOENT (No such file or directory)
open("/lib/x86_64-linux-gnu/libc.so.6", O_RDONLY|O_CLOEXECopen("/lib/x86_64-linux-gnu/libc.so.6", O_RDONLY|O_CLOEXEC) = 3
) = 3
read(3, read(3, "\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0P\t\2\0\0\0\0\0@\0\0\0\0\0\0\0\270b\34\0\0\0\0\0\0\0\0\0@\0008\0\n\0@\0H\0G\0\6\0\0\0\5\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0000\2\0\0"..., 832) = 832
"\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0P\t\2\0\0\0\0\0@\0\0\0\0\0\0\0\270b\34\0\0\0\0\0\0\0\0\0@\0008\0\n\0@\0H\0G\0\6\0\0\0\5\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0000\2\0\0"..., 832) = 832
fstat(3, fstat(3, {st_mode=S_IFREG|0755, st_size=1864888, ...}) = 0
{st_mode=S_IFREG|0755, st_size=1864888, ...}) = 0
mmap(NULL, 3967392, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0mmap(NULL, 3967392, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7fb6a033d000
) = 0x7fb6a033d000
mprotect(0x7fb6a04fc000, 2097152, PROT_NONEmprotect(0x7fb6a04fc000, 2097152, PROT_NONE) = 0
) = 0
mmap(0x7fb6a06fc000, 24576, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1bf000mmap(0x7fb6a06fc000, 24576, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1bf000) = 0x7fb6a06fc000
) = 0x7fb6a06fc000
mmap(0x7fb6a0702000, 14752, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0mmap(0x7fb6a0702000, 14752, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7fb6a0702000
) = 0x7fb6a0702000
close(3close(3)                                = 0
)                                = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fb6a0910000
) = 0x7fb6a0910000
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fb6a090f000
) = 0x7fb6a090f000
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fb6a090e000
) = 0x7fb6a090e000
arch_prctl(ARCH_SET_FS, 0x7fb6a090f700arch_prctl(ARCH_SET_FS, 0x7fb6a090f700) = 0
) = 0
mprotect(0x7fb6a06fc000, 16384, PROT_READmprotect(0x7fb6a06fc000, 16384, PROT_READ) = 0
) = 0
mprotect(0x600000, 4096, PROT_READmprotect(0x600000, 4096, PROT_READ)     = 0
)     = 0
mprotect(0x7fb6a092b000, 4096, PROT_READmprotect(0x7fb6a092b000, 4096, PROT_READ) = 0
) = 0
munmap(0x7fb6a0911000, 97481munmap(0x7fb6a0911000, 97481)           = 0
)           = 0
getegid(getegid()                               = 1000
)                               = 1000
setresgid(1000, 1000, 1000setresgid(1000, 1000, 1000)             = 0
)             = 0
execve("/bin/sh", ["/bin/sh"], NULLexecve("/bin/sh", ["/bin/sh"], NULL)    = 0
)    = 0
brk(NULLbrk(NULL)                               = 0x5609bcd33000
)                               = 0x5609bcd33000
access("/etc/ld.so.nohwcap", F_OKaccess("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
)      = -1 ENOENT (No such file or directory)
mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fce3e758000
) = 0x7fce3e758000
access("/etc/ld.so.preload", R_OKaccess("/etc/ld.so.preload", R_OK)      = -1 ENOENT (No such file or directory)
)      = -1 ENOENT (No such file or directory)
open("/etc/ld.so.cache", O_RDONLY|O_CLOEXECopen("/etc/ld.so.cache", O_RDONLY|O_CLOEXEC) = 3
) = 3
fstat(3, fstat(3, {st_mode=S_IFREG|0644, st_size=97481, ...}) = 0
{st_mode=S_IFREG|0644, st_size=97481, ...}) = 0
mmap(NULL, 97481, PROT_READ, MAP_PRIVATE, 3, 0mmap(NULL, 97481, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7fce3e740000
) = 0x7fce3e740000
close(3close(3)                                = 0
)                                = 0
access("/etc/ld.so.nohwcap", F_OKaccess("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
)      = -1 ENOENT (No such file or directory)
open("/lib/x86_64-linux-gnu/libc.so.6", O_RDONLY|O_CLOEXECopen("/lib/x86_64-linux-gnu/libc.so.6", O_RDONLY|O_CLOEXEC) = 3
) = 3
read(3, read(3, "\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0P\t\2\0\0\0\0\0@\0\0\0\0\0\0\0\270b\34\0\0\0\0\0\0\0\0\0@\0008\0\n\0@\0H\0G\0\6\0\0\0\5\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0000\2\0\0"..., 832) = 832
"\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0P\t\2\0\0\0\0\0@\0\0\0\0\0\0\0\270b\34\0\0\0\0\0\0\0\0\0@\0008\0\n\0@\0H\0G\0\6\0\0\0\5\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0000\2\0\0"..., 832) = 832
fstat(3, fstat(3, {st_mode=S_IFREG|0755, st_size=1864888, ...}) = 0
{st_mode=S_IFREG|0755, st_size=1864888, ...}) = 0
mmap(NULL, 3967392, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0mmap(NULL, 3967392, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7fce3e16c000
) = 0x7fce3e16c000
mprotect(0x7fce3e32b000, 2097152, PROT_NONEmprotect(0x7fce3e32b000, 2097152, PROT_NONE) = 0
) = 0
mmap(0x7fce3e52b000, 24576, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1bf000mmap(0x7fce3e52b000, 24576, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1bf000) = 0x7fce3e52b000
) = 0x7fce3e52b000
mmap(0x7fce3e531000, 14752, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0mmap(0x7fce3e531000, 14752, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7fce3e531000
) = 0x7fce3e531000
close(3close(3)                                = 0
)                                = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fce3e73f000
) = 0x7fce3e73f000
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fce3e73e000
) = 0x7fce3e73e000
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fce3e73d000
) = 0x7fce3e73d000
arch_prctl(ARCH_SET_FS, 0x7fce3e73e700arch_prctl(ARCH_SET_FS, 0x7fce3e73e700) = 0
) = 0
mprotect(0x7fce3e52b000, 16384, PROT_READmprotect(0x7fce3e52b000, 16384, PROT_READ) = 0
) = 0
mprotect(0x5609bb2a9000, 8192, PROT_READmprotect(0x5609bb2a9000, 8192, PROT_READ) = 0
) = 0
mprotect(0x7fce3e75a000, 4096, PROT_READmprotect(0x7fce3e75a000, 4096, PROT_READ) = 0
) = 0
munmap(0x7fce3e740000, 97481munmap(0x7fce3e740000, 97481)           = 0
)           = 0
getuid(getuid()                                = 1000
)                                = 1000
getgid(getgid()                                = 1000
)                                = 1000
getpid(getpid()                                = 22912
)                                = 22912
rt_sigaction(SIGCHLD, {0x5609bb09d540, ~[RTMIN RT_1], SA_RESTORER, 0x7fce3e1a14b0}, rt_sigaction(SIGCHLD, {0x5609bb09d540, ~[RTMIN RT_1], SA_RESTORER, 0x7fce3e1a14b0}, NULL, 8) = 0
NULL, 8) = 0
geteuid(geteuid()                               = 1000
)                               = 1000
brk(NULLbrk(NULL)                               = 0x5609bcd33000
)                               = 0x5609bcd33000
brk(0x5609bcd54000brk(0x5609bcd54000)                     = 0x5609bcd54000
)                     = 0x5609bcd54000
getppid(getppid()                               = 22909
)                               = 22909
getcwd(getcwd("/home/user/ctf/angstromCTF2017/ArtOfShell", 4096) = 42
"/home/user/ctf/angstromCTF2017/ArtOfShell", 4096) = 42
ioctl(0, TCGETSioctl(0, TCGETS, {B38400 opost isig icanon echo ...}) = 0
, {B38400 opost isig icanon echo ...}) = 0
ioctl(1, TCGETSioctl(1, TCGETS, {B38400 opost isig icanon echo ...}) = 0
, {B38400 opost isig icanon echo ...}) = 0
geteuid(geteuid()                               = 1000
)                               = 1000
getegid(getegid()                               = 1000
)                               = 1000
rt_sigaction(SIGINT, NULL, rt_sigaction(SIGINT, NULL, {SIG_DFL, [], 0}, 8) = 0
{SIG_DFL, [], 0}, 8) = 0
rt_sigaction(SIGINT, {0x5609bb09d540, ~[RTMIN RT_1], SA_RESTORER, 0x7fce3e1a14b0}, rt_sigaction(SIGINT, {0x5609bb09d540, ~[RTMIN RT_1], SA_RESTORER, 0x7fce3e1a14b0}, NULL, 8) = 0
NULL, 8) = 0
rt_sigaction(SIGQUIT, NULL, rt_sigaction(SIGQUIT, NULL, {SIG_DFL, [], 0}, 8) = 0
{SIG_DFL, [], 0}, 8) = 0
rt_sigaction(SIGQUIT, {SIG_IGN, ~[RTMIN RT_1], SA_RESTORER, 0x7fce3e1a14b0}, rt_sigaction(SIGQUIT, {SIG_IGN, ~[RTMIN RT_1], SA_RESTORER, 0x7fce3e1a14b0}, NULL, 8) = 0
NULL, 8) = 0
rt_sigaction(SIGTERM, NULL, rt_sigaction(SIGTERM, NULL, {SIG_DFL, [], 0}, 8) = 0
{SIG_DFL, [], 0}, 8) = 0
rt_sigaction(SIGTERM, {SIG_IGN, ~[RTMIN RT_1], SA_RESTORER, 0x7fce3e1a14b0}, rt_sigaction(SIGTERM, {SIG_IGN, ~[RTMIN RT_1], SA_RESTORER, 0x7fce3e1a14b0}, NULL, 8) = 0
NULL, 8) = 0
open("/dev/tty", O_RDWRopen("/dev/tty", O_RDWR)                = 3
)                = 3
fcntl(3, F_DUPFD, 10fcntl(3, F_DUPFD, 10)                   = 10
)                   = 10
close(3close(3)                                = 0
)                                = 0
fcntl(10, F_SETFD, FD_CLOEXECfcntl(10, F_SETFD, FD_CLOEXEC)          = 0
)          = 0
ioctl(10, TIOCGPGRPioctl(10, TIOCGPGRP, [22909])           = 0
, [22909])           = 0
getpgrp(getpgrp()                               = 22909
)                               = 22909
rt_sigaction(SIGTSTP, NULL, rt_sigaction(SIGTSTP, NULL, {SIG_DFL, [], 0}, 8) = 0
{SIG_DFL, [], 0}, 8) = 0
rt_sigaction(SIGTSTP, {SIG_IGN, ~[RTMIN RT_1], SA_RESTORER, 0x7fce3e1a14b0}, rt_sigaction(SIGTSTP, {SIG_IGN, ~[RTMIN RT_1], SA_RESTORER, 0x7fce3e1a14b0}, NULL, 8) = 0
NULL, 8) = 0
rt_sigaction(SIGTTOU, NULL, rt_sigaction(SIGTTOU, NULL, {SIG_DFL, [], 0}, 8) = 0
{SIG_DFL, [], 0}, 8) = 0
rt_sigaction(SIGTTOU, {SIG_IGN, ~[RTMIN RT_1], SA_RESTORER, 0x7fce3e1a14b0}, rt_sigaction(SIGTTOU, {SIG_IGN, ~[RTMIN RT_1], SA_RESTORER, 0x7fce3e1a14b0}, NULL, 8) = 0
NULL, 8) = 0
rt_sigaction(SIGTTIN, NULL, rt_sigaction(SIGTTIN, NULL, {SIG_DFL, [], 0}, 8) = 0
{SIG_DFL, [], 0}, 8) = 0
rt_sigaction(SIGTTIN, {SIG_DFL, ~[RTMIN RT_1], SA_RESTORER, 0x7fce3e1a14b0}, rt_sigaction(SIGTTIN, {SIG_DFL, ~[RTMIN RT_1], SA_RESTORER, 0x7fce3e1a14b0}, NULL, 8) = 0
NULL, 8) = 0
setpgid(0, 22912setpgid(0, 22912)                       = 0
)                       = 0
ioctl(10, TIOCSPGRP, [22912]ioctl(10, TIOCSPGRP, [22912])           = 0
)           = 0
wait4(-1, wait4(-1, 0x7ffed09a36fc, WNOHANG|WSTOPPED, NULL) = -1 ECHILD (No child processes)
0x7ffed09a36fc, WNOHANG|WSTOPPED, NULL) = -1 ECHILD (No child processes)
write(2, "$ ", 2write(2, "$ ", 2$ $ )                       = 2
)                       = 2
read(0, read(0, "exit\n", 8192)                 = 5
"exit\n", 8192)                 = 5
ioctl(10, TIOCSPGRP, [22909]ioctl(10, TIOCSPGRP, [22909])           = 0
)           = 0
setpgid(0, 22909setpgid(0, 22909)                       = 0
)                       = 0
close(10close(10)                               = 0
)                               = 0
exit_group(0)                           = ?
exit_group(0)                           = ?
+++ exited with 0 +++
+++ exited with 0 +++
